###############################################
# Apricus Restaurant API Test Requests
# استخدم هذا الملف لاختبار جميع نقاط الوصول API
# قم بتثبيت REST Client extension في VS Code لتشغيل الطلبات
###############################################

# متغيرات عامة
@baseUrl = http://localhost:3000
@apiUrl = {{baseUrl}}/api
@contentType = application/json

# سيتم تحديث هذا بعد تسجيل الدخول
@authToken = your_token_here

###############################################
# 1. API Base & Health Check
###############################################

### فحص API الأساسي
GET {{apiUrl}}

### اختبار الاتصال بقاعدة البيانات
GET {{apiUrl}}/menu/test

###############################################
# 2. Authentication (التسجيل وتسجيل الدخول)
###############################################

### تسجيل مستخدم جديد
POST {{apiUrl}}/auth/register
Content-Type: {{contentType}}

{
  "email": "test@example.com",
  "password": "Password123",
  "name": "Test User"
}

### تسجيل الدخول
POST {{apiUrl}}/auth/login
Content-Type: {{contentType}}

{
  "email": "test@example.com",
  "password": "Password123"
}

### تسجيل الدخول كمسؤول
POST {{apiUrl}}/auth/login
Content-Type: {{contentType}}

{
  "email": "admin@example.com",
  "password": "admin123"
}

###############################################
# 3. Categories (الفئات)
###############################################

### جلب جميع الفئات
GET {{apiUrl}}/menu/categories

### جلب فئة محددة (ID = 1)
GET {{apiUrl}}/menu/categories/1

### جلب وصفات فئة محددة
GET {{apiUrl}}/menu/categories/1/recipes

###############################################
# 4. Recipes (الوصفات)
###############################################

### جلب جميع الوصفات
GET {{apiUrl}}/menu/recipes

### جلب الوصفات المتوفرة فقط
GET {{apiUrl}}/menu/recipes?available=true

### البحث في الوصفات
GET {{apiUrl}}/menu/recipes?search=kabsa

### تصفية حسب الفئة
GET {{apiUrl}}/menu/recipes?category=1

### جلب وصفة محددة (ID = 1)
GET {{apiUrl}}/menu/recipes/1

### قائمة اليوم (الوصفات المميزة)
GET {{apiUrl}}/menu/today

###############################################
# 5. Orders (الطلبات - للعملاء)
###############################################

### إنشاء طلب جديد
POST {{apiUrl}}/menu/orders
Content-Type: {{contentType}}

{
  "customerName": "أحمد محمد",
  "customerPhone": "+358401234567",
  "customerEmail": "ahmad@example.com",
  "items": [
    {
      "recipe_id": 1,
      "quantity": 2,
      "special_instructions": "بدون بصل"
    },
    {
      "recipe_id": 2,
      "quantity": 1
    }
  ],
  "notes": "التوصيل في أقرب وقت",
  "deliveryAddress": "شارع الرئيسي 123، المدينة"
}

### إنشاء طلب استلام (Pickup)
POST {{apiUrl}}/menu/orders
Content-Type: {{contentType}}

{
  "customerName": "سارة علي",
  "customerPhone": "+358407654321",
  "items": [
    {
      "recipe_id": 3,
      "quantity": 1
    }
  ],
  "notes": "سأستلمه بنفسي"
}

### جلب طلب محدد (ID = 1)
GET {{apiUrl}}/menu/orders/1

###############################################
# 6. Admin - Orders Management (إدارة الطلبات)
###############################################

### جلب جميع الطلبات (يتطلب صلاحيات)
GET {{apiUrl}}/admin/orders
Authorization: Bearer {{authToken}}

### جلب الطلبات المعلقة
GET {{apiUrl}}/admin/orders?status=pending
Authorization: Bearer {{authToken}}

### جلب آخر 10 طلبات
GET {{apiUrl}}/admin/orders?limit=10
Authorization: Bearer {{authToken}}

### تحديث حالة الطلب إلى "مؤكد"
PATCH {{apiUrl}}/admin/orders/1/status
Content-Type: {{contentType}}
Authorization: Bearer {{authToken}}

{
  "status": "confirmed"
}

### تحديث حالة الطلب إلى "قيد التحضير"
PATCH {{apiUrl}}/admin/orders/1/status
Content-Type: {{contentType}}
Authorization: Bearer {{authToken}}

{
  "status": "preparing"
}

### تحديث حالة الطلب إلى "جاهز"
PATCH {{apiUrl}}/admin/orders/1/status
Content-Type: {{contentType}}
Authorization: Bearer {{authToken}}

{
  "status": "ready"
}

### تحديث حالة الطلب إلى "تم التوصيل"
PATCH {{apiUrl}}/admin/orders/1/status
Content-Type: {{contentType}}
Authorization: Bearer {{authToken}}

{
  "status": "delivered"
}

### إلغاء الطلب
PATCH {{apiUrl}}/admin/orders/1/status
Content-Type: {{contentType}}
Authorization: Bearer {{authToken}}

{
  "status": "cancelled"
}

###############################################
# 7. Admin - Recipe Management (إدارة الوصفات)
###############################################

### إضافة وصفة جديدة
POST {{apiUrl}}/admin/recipes
Content-Type: {{contentType}}
Authorization: Bearer {{authToken}}

{
  "name": "مندي لحم",
  "nameEn": "Mandi Meat",
  "description": "مندي لحم تقليدي مع أرز بسمتي",
  "price": 22.90,
  "category": 1,
  "image": "/assets/img/mandi.jpg",
  "ingredients": [
    "لحم غنم",
    "أرز بسمتي",
    "بهارات مندي",
    "طماطم",
    "بصل"
  ],
  "preparationTime": 45,
  "isAvailable": true
}

### تحديث وصفة موجودة
PUT {{apiUrl}}/admin/recipes/1
Content-Type: {{contentType}}
Authorization: Bearer {{authToken}}

{
  "name": "كبسة دجاج محدثة",
  "price": 17.90,
  "isAvailable": true
}

### تعطيل وصفة (جعلها غير متوفرة)
PUT {{apiUrl}}/admin/recipes/1
Content-Type: {{contentType}}
Authorization: Bearer {{authToken}}

{
  "isAvailable": false
}

### حذف وصفة
DELETE {{apiUrl}}/admin/recipes/1
Authorization: Bearer {{authToken}}

###############################################
# 8. Admin - Statistics (الإحصائيات)
###############################################

### جلب إحصائيات المطعم
GET {{apiUrl}}/admin/stats
Authorization: Bearer {{authToken}}

###############################################
# 9. Admin - Users Management (إدارة المستخدمين)
###############################################

### جلب جميع المستخدمين
GET {{apiUrl}}/admin/users
Authorization: Bearer {{authToken}}

###############################################
# 10. Admin - Protected Routes (المسارات المحمية)
###############################################

### اختبار مسار الإدارة المحمي
GET {{apiUrl}}/admin/secret
Authorization: Bearer {{authToken}}

###############################################
# 11. Error Testing (اختبار الأخطاء)
###############################################

### محاولة الوصول بدون مصادقة
GET {{apiUrl}}/admin/orders

### محاولة الوصول إلى وصفة غير موجودة
GET {{apiUrl}}/menu/recipes/9999

### إنشاء طلب بدون بيانات مطلوبة
POST {{apiUrl}}/menu/orders
Content-Type: {{contentType}}

{
  "customerName": "اسم فقط"
}

### تحديث طلب بحالة غير صحيحة
PATCH {{apiUrl}}/admin/orders/1/status
Content-Type: {{contentType}}
Authorization: Bearer {{authToken}}

{
  "status": "invalid_status"
}

###############################################
# ملاحظات الاستخدام:
###############################################
# 1. قم بتثبيت "REST Client" extension في VS Code
# 2. ابدأ الخادم باستخدام: npm start أو node server.js
# 3. للمسارات المحمية، قم بتسجيل الدخول أولاً ونسخ التوكن
# 4. استبدل @authToken بالتوكن الفعلي الذي حصلت عليه
# 5. انقر على "Send Request" أعلى كل طلب لتنفيذه
# 6. يمكنك فصل الطلبات باستخدام ###

###############################################
# مثال على تحديث التوكن:
###############################################
# بعد تسجيل الدخول، استبدل السطر التالي بالتوكن الفعلي:
# @authToken = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
